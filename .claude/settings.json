{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "python3 -c \"\nimport sys, json, os, re\ntry:\n    inp = json.load(sys.stdin)\nexcept Exception:\n    sys.exit(0)\ntool = inp.get('tool_name', '')\npath = inp.get('tool_input', {}).get('file_path', '')\nif 'package-lock.json' in path:\n    print('BLOCKED: Do not edit package-lock.json directly. Run npm install to update it.', file=sys.stderr)\n    sys.exit(1)\n\n# Design-token-guard: block primitive tokens being used directly in component files\nbasename = os.path.basename(path)\nis_component_ts = (path.endswith(('.tsx', '.ts')) and 'globals.css' not in path and 'multi-repo-nextjs' in path)\nis_component_swift = (path.endswith('.swift') and 'DesignTokens.swift' not in basename and 'multi-repo-ios' in path)\ncontent = inp.get('tool_input', {}).get('new_string', '') or inp.get('tool_input', {}).get('content', '')\nif is_component_ts and content:\n    # Flag var(--color-*) primitive token references in component TSX/TS\n    primitives = re.findall(r'var\\(--color-[a-z0-9-]+\\)', content)\n    if primitives:\n        unique = list(dict.fromkeys(primitives))\n        print('[design-token-guard] BLOCKED: Primitive token(s) used directly in component file.', file=sys.stderr)\n        print(f'[design-token-guard] Found: {unique}', file=sys.stderr)\n        print('[design-token-guard] Use semantic tokens (var(--surfaces-*), var(--typography-*), etc.) instead.', file=sys.stderr)\n        sys.exit(1)\nif is_component_swift and content:\n    # Flag Color.color* primitive references in component Swift files\n    primitives = re.findall(r'\\.color(?:Zinc|Slate|Neutral|Red|Amber|Green|Indigo|Base)[A-Z][a-zA-Z0-9]+', content)\n    if primitives:\n        unique = list(dict.fromkeys(primitives))\n        print('[design-token-guard] BLOCKED: Primitive token(s) used directly in Swift component file.', file=sys.stderr)\n        print(f'[design-token-guard] Found: {unique}', file=sys.stderr)\n        print('[design-token-guard] Use semantic tokens (Color.surfaces*, Color.typography*, etc.) instead.', file=sys.stderr)\n        sys.exit(1)\n\""
          },
          {
            "type": "command",
            "command": "python3 -c \"\nimport sys, json, os, re\ntry:\n    inp = json.load(sys.stdin)\nexcept Exception:\n    sys.exit(0)\npath = inp.get('tool_input', {}).get('file_path', '')\nbasename = os.path.basename(path)\ncontent = inp.get('tool_input', {}).get('new_string', '') or inp.get('tool_input', {}).get('content', '')\nif not content:\n    sys.exit(0)\n\nis_component_ts = (path.endswith(('.tsx', '.ts')) and 'globals.css' not in path and 'multi-repo-nextjs' in path and 'node_modules' not in path)\nis_component_swift = (path.endswith('.swift') and 'DesignTokens.swift' not in basename and 'multi-repo-ios' in path)\n\nif not (is_component_ts or is_component_swift):\n    sys.exit(0)\n\nviolations = []\n\nif is_component_ts:\n    # BaseHighContrast and BaseLowContrastPressed must not be used for borders/structural elements.\n    # The only allowed use of low-contrast-pressed is for interactive pressed/active states.\n    bad_high = re.findall(r'var\\(--surfaces-base-high-contrast(?!-hover|-pressed)[^)]*\\)', content)\n    bad_low_pressed_non_interactive = re.findall(r'var\\(--surfaces-base-low-contrast-pressed[^)]*\\)', content)\n    for m in bad_high:\n        violations.append(f'  TSX: {m}  →  Use var(--border-default) or var(--border-muted) for borders/lines')\n    for m in bad_low_pressed_non_interactive:\n        violations.append(f'  TSX: {m}  →  Only allowed for pressed/active interactive states (Chip, Button). Use var(--border-default) for structural lines.')\n\nif is_component_swift:\n    bad_high = re.findall(r'\\.surfacesBaseHighContrast(?!Hover|Pressed)', content)\n    bad_low_pressed = re.findall(r'\\.surfacesBaseLowContrastPressed', content)\n    for m in bad_high:\n        violations.append(f'  Swift: {m}  →  Use .appBorderDefault or .appBorderMuted for borders/lines')\n    for m in bad_low_pressed:\n        violations.append(f'  Swift: {m}  →  Only allowed for pressed/active states (Chip ON, Button pressed). Use .appBorderDefault for structural lines.')\n\nif violations:\n    print('', file=sys.stderr)\n    print('[design-token-semantics-guard] BLOCKED: Semantic token misuse detected:', file=sys.stderr)\n    for v in violations:\n        print(v, file=sys.stderr)\n    print('', file=sys.stderr)\n    print('[design-token-semantics-guard] Token semantic rules:', file=sys.stderr)\n    print('  BaseLowContrastPressed  → interactive pressed/active state ONLY (Chip ON, Button press)', file=sys.stderr)\n    print('  BaseHighContrast        → higher-prominence surface ONLY (not for borders/lines)', file=sys.stderr)\n    print('  Border/Default          → dividers, separators, input borders, connector lines', file=sys.stderr)\n    print('  Border/Muted            → subtle row dividers, hairline separators', file=sys.stderr)\n    print('', file=sys.stderr)\n    print('[design-token-semantics-guard] See docs/design-tokens.md#important-semantic-token-guidelines', file=sys.stderr)\n    sys.exit(1)\n\""
          },
          {
            "type": "command",
            "command": "python3 -c \"\nimport sys, json, re\ntry:\n    inp = json.load(sys.stdin)\nexcept Exception:\n    sys.exit(0)\npath = inp.get('tool_input', {}).get('file_path', '')\ncontent = inp.get('tool_input', {}).get('content', '') or inp.get('tool_input', {}).get('new_string', '')\nif not content:\n    sys.exit(0)\nif not (path.endswith('.tsx') or path.endswith('.swift')):\n    sys.exit(0)\n# Only fire on new file writes (content present), not small edits\nif inp.get('tool_name') not in ('Write',):\n    sys.exit(0)\n# Check if file composes 2+ known atomic components\natomics = ['Button', 'IconButton', 'Badge', 'Label', 'Chip', 'Tabs', 'SegmentControlBar', 'Thumbnail', 'InputField', 'Toast', 'Divider']\nfound = [c for c in atomics if re.search(r'\\b' + c + r'\\b', content)]\nif len(found) >= 2:\n    print('')\n    print('[complex-component-clarifier] This file composes multiple atomic components: ' + ', '.join(found))\n    print('[complex-component-clarifier] Before writing, confirm you have clarified:')\n    print('[complex-component-clarifier]   1. State ownership — who owns what state (parent vs child)?')\n    print('[complex-component-clarifier]   2. Keyboard interactions — tab order, Enter/Space, Escape?')\n    print('[complex-component-clarifier]   3. Figma scope — using Figma as visual reference only, not structural truth?')\n    print('[complex-component-clarifier]   4. All states handled — loading, empty, error, disabled?')\n    print('[complex-component-clarifier] Run /complex-component <name> to go through the full clarification phase.')\n    print('')\n\""
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write",
        "hooks": [
          {
            "type": "command",
            "command": "python3 -c \"\nimport sys, json, os, re\ntry:\n    inp = json.load(sys.stdin)\nexcept Exception:\n    sys.exit(0)\npath = inp.get('tool_input', {}).get('file_path', '')\nif not path:\n    sys.exit(0)\n\n# Only fire on new component files (not demo/page/test files)\nis_web_component = (\n    path.endswith('.tsx')\n    and 'multi-repo-nextjs' in path\n    and '/components/' in path\n    and 'page.tsx' not in path\n    and '-demo' not in path\n    and 'index.' not in path\n)\nis_ios_component = (\n    path.endswith('.swift')\n    and 'multi-repo-ios' in path\n    and '/Components/' in path\n    and 'ContentView' not in path\n    and 'App.swift' not in path\n    and 'DesignTokens' not in path\n    and 'Preview' not in path\n)\n\nif is_web_component or is_ios_component:\n    basename = os.path.basename(path)\n    platform = 'Web' if is_web_component else 'iOS'\n    counterpart = 'iOS (ContentView.swift)' if is_web_component else 'Web (app/page.tsx)'\n    demo_file = 'multi-repo-nextjs/app/page.tsx' if is_web_component else 'multi-repo-ios/.../ContentView.swift'\n    print('')\n    print(f'[auto-demo-updater] New {platform} component written: {basename}')\n    print(f'[auto-demo-updater] Remember to add showcase examples to:')\n    print(f'[auto-demo-updater]   1. {demo_file}  ({platform} demo page)')\n    print(f'[auto-demo-updater]   2. Counterpart demo for {counterpart}')\n    print(f'[auto-demo-updater]   3. Update docs/components.md registry with Status: Done')\n    print('')\n\""
          }
        ]
      },
      {
        "matcher": "Edit|Write",
        "hooks": [
          {
            "type": "command",
            "command": "python3 -c \"\nimport sys, json, os, re\ntry:\n    inp = json.load(sys.stdin)\nexcept Exception:\n    sys.exit(0)\npath = inp.get('tool_input', {}).get('file_path', '')\ncontent = inp.get('tool_input', {}).get('content', '') or inp.get('tool_input', {}).get('new_string', '')\nif not path or not content:\n    sys.exit(0)\n# Only fire on iOS screen/feature Swift files, NOT on Components/Native/ wrappers or NativeComponentStyling\nif not (path.endswith('.swift') and 'multi-repo-ios' in path):\n    sys.exit(0)\nif '/Components/Native/' in path or 'NativeComponentStyling' in path or 'DesignTokens' in path:\n    sys.exit(0)\n# Check for raw SwiftUI APIs that have App* wrappers\nraw_apis = {\n    r'\\bPicker\\s*\\(': 'AppNativePicker',\n    r'\\bDatePicker\\s*\\(': 'AppDateTimePicker',\n    r'\\bProgressView\\s*\\(': 'AppProgressLoader',\n    r'\\bColorPicker\\s*\\(': 'AppColorPicker',\n    r'\\.sheet\\s*\\(': 'AppBottomSheet (.appBottomSheet modifier)',\n    r'\\.confirmationDialog\\s*\\(': 'AppActionSheet (.appActionSheet modifier)',\n    r'\\.alert\\s*\\(': 'AppAlertPopup (.appAlert modifier)',\n    r'\\.contextMenu\\s*\\(': 'AppContextMenu (.appContextMenu modifier)',\n}\nfound = []\nfor pattern, wrapper in raw_apis.items():\n    if re.search(pattern, content):\n        found.append((pattern.replace('\\\\b','').replace('\\\\s*\\\\(','(').replace('\\\\.','.')[:25], wrapper))\nif found:\n    print('')\n    print('[native-wrapper-guard] Raw SwiftUI API detected in screen file:')\n    for raw, wrapper in found:\n        print(f'[native-wrapper-guard]   {raw}  ->  Use {wrapper} from Components/Native/ instead')\n    print('[native-wrapper-guard] Native wrappers apply consistent styling from NativeComponentStyling.swift.')\n    print('')\n\""
          },
          {
            "type": "command",
            "command": "python3 -c \"\nimport sys, json, os\ntry:\n    inp = json.load(sys.stdin)\nexcept Exception:\n    sys.exit(0)\npath = inp.get('tool_input', {}).get('file_path', '')\nif not path:\n    sys.exit(0)\nbasename = os.path.basename(path)\nif path.endswith('.swift'):\n    print(f'[cross-platform] Edited {basename}')\n    print('[cross-platform] Reminder: check if a web counterpart exists in multi-repo-nextjs/ for this feature.')\nelif path.endswith(('.tsx', '.ts')) and 'multi-repo-nextjs' in path:\n    print(f'[cross-platform] Edited {basename}')\n    print('[cross-platform] Reminder: check if an iOS counterpart exists in multi-repo-ios/ for this feature.')\nelif 'globals.css' in path or ('Color' in basename and path.endswith('.swift')):\n    print('[design-token-sync] Design token file changed.')\n    print('[design-token-sync] Run /design-token-sync to keep CSS variables and Swift Color extensions in sync.')\nelif 'Icon' in basename and (path.endswith('.tsx') or path.endswith('.swift')):\n    print('[icon-system] Icon system file changed.')\n    print('[icon-system] Ensure web <Icon /> wrapper and iOS PhosphorIcon view stay in sync.')\n    print('[icon-system] Verify docs/design-tokens.md#icon-system is up to date.')\n\""
          },
          {
            "type": "command",
            "command": "python3 -c \"\nimport sys, json, os\ntry:\n    inp = json.load(sys.stdin)\nexcept Exception:\n    sys.exit(0)\npath = inp.get('tool_input', {}).get('file_path', '')\nif not path:\n    sys.exit(0)\nif not (path.endswith('.tsx') or path.endswith('.swift')):\n    sys.exit(0)\n# Skip non-component files\nif 'components' not in path and 'Components' not in path:\n    sys.exit(0)\ncontent = inp.get('tool_input', {}).get('content', '') or inp.get('tool_input', {}).get('new_string', '')\nif not content:\n    sys.exit(0)\nlines = content.split('\\n')\ntotal = len(lines)\ncomment_lines = [l for l in lines if l.strip().startswith('//') or l.strip().startswith('/*') or l.strip().startswith('*')]\nif total > 80 and len(comment_lines) < 3:\n    basename = os.path.basename(path)\n    print(f'[comment-enforcer] {basename} has {total} lines but only {len(comment_lines)} comment line(s).')\n    print('[comment-enforcer] Complex components (>80 lines) require section headers and JSDoc/MARK comments.')\n    print('[comment-enforcer] Web: // --- Props, // --- State, // --- Render')\n    print('[comment-enforcer] iOS: // MARK: - Properties, // MARK: - Body, // MARK: - Subviews')\n\""
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "python3 -c \"\nimport subprocess, sys, os\n\n# Check which repos have unpushed commits\nrepos = {\n    'workspace (multi-repo-sample)': '/Users/abhishekverma/Documents/multi-repo-sample',\n    'multi-repo-nextjs': '/Users/abhishekverma/Documents/multi-repo-sample/multi-repo-nextjs',\n    'multi-repo-ios': '/Users/abhishekverma/Documents/multi-repo-sample/multi-repo-ios',\n}\n\ndirty = []\nfor name, path in repos.items():\n    try:\n        status = subprocess.run(['git', 'status', '--porcelain'], cwd=path, capture_output=True, text=True)\n        ahead = subprocess.run(['git', 'log', '--oneline', '@{u}..HEAD'], cwd=path, capture_output=True, text=True)\n        if status.stdout.strip() or ahead.stdout.strip():\n            dirty.append(name)\n    except Exception:\n        pass\n\nif dirty:\n    print('')\n    print('\\u250c' + '\\u2500' * 58 + '\\u2510')\n    print('\\u2502  \\U0001f4e4  Unpushed changes detected                           \\u2502')\n    print('\\u251c' + '\\u2500' * 58 + '\\u2524')\n    for r in dirty:\n        label = f'  \\u2022 {r}'\n        print(f'\\u2502{label:<58}\\u2502')\n    print('\\u251c' + '\\u2500' * 58 + '\\u2524')\n    print('\\u2502  Run /git-push to commit and push all repos.          \\u2502')\n    print('\\u2514' + '\\u2500' * 58 + '\\u2518')\n    print('')\n\nprint('')\nprint('\\u250c' + '\\u2500' * 58 + '\\u2510')\nprint('\\u2502  \\U0001f4dd  Post-session checklist                            \\u2502')\nprint('\\u251c' + '\\u2500' * 58 + '\\u2524')\nprint('\\u2502  Evaluate whether these need updating:                \\u2502')\nprint('\\u2502  \\u2022 docs/design-tokens.md (new tokens added?)         \\u2502')\nprint('\\u2502  \\u2022 docs/api-contracts.md (schema changes?)           \\u2502')\nprint('\\u2502  \\u2022 CLAUDE.md files (new conventions/packages?)       \\u2502')\nprint('\\u2502  \\u2022 .claude/skills/ (new repeatable workflow?)        \\u2502')\nprint('\\u2502  \\u2022 .claude/agents/ (new validation needed?)          \\u2502')\nprint('\\u2502  Run /post-session-review for guided checklist.      \\u2502')\nprint('\\u2514' + '\\u2500' * 58 + '\\u2518')\nprint('')\n\""
          }
        ]
      }
    ],
    "Notification": [
      {
        "matcher": "idle_prompt",
        "hooks": [
          {
            "type": "command",
            "command": "osascript -e 'display notification \"Claude is waiting for input\" with title \"Claude Code\" sound name \"Ping\"' 2>/dev/null || true"
          }
        ]
      }
    ]
  }
}
